

# 📄 Mock API 명세서 상세

본 문서는 `CommonResponse<T>` 공통 응답 포맷을 기준으로  
각 API별 상세 요청/응답 예시 및 에러 케이스를 정리한 문서입니다.

---

## ✅ 공통 응답 포맷

```json
{
  "success": true | false,
  "message": "응답 메시지",
  "data": object | null,
  "status": 200 | 400 | 404 | ...
}
````

---

## 1. 포인트 잔액 조회 API

* **Endpoint**: `GET /points/{userId}`

```json
// Success
{
  "success": true,
  "message": "성공",
  "data": {
    "userId": 1,
    "point": 15000
  },
  "status": 200
}
```

| 상태 코드 | 메시지                | 설명          |
| ----- | ------------------ | ----------- |
| 404   | 해당 사용자를 찾을 수 없습니다. | 존재하지 않는 사용자 |

---

## 2. 포인트 충전 API

* **Endpoint**: `PATCH /points/{userId}/charge`

```json
// Request
{ "amount": 1000 }

// Success
{
  "success": true,
  "message": "포인트 충전 완료",
  "data": {
    "userId": 1,
    "point": 20000
  },
  "status": 200
}
```

| 상태 코드 | 메시지                    | 설명           |
| ----- | ---------------------- | ------------ |
| 400   | 0원 이하의 금액은 충전할 수 없습니다. | amount가 0 이하 |
| 404   | 해당 사용자를 찾을 수 없습니다.     | 존재하지 않는 사용자  |

---

## 3. 포인트 사용 API

* **Endpoint**: `PATCH /points/{userId}/use`

```json
// Request
{ "amount": 1000 }

// Success
{
  "success": true,
  "message": "포인트 사용 완료",
  "data": {
    "userId": 1,
    "point": 5000
  },
  "status": 200
}
```

| 상태 코드 | 메시지                | 설명     |
| ----- | ------------------ | ------ |
| 400   | 포인트가 부족합니다.        | 포인트 부족 |
| 404   | 해당 사용자를 찾을 수 없습니다. | 없음     |

---

## 4. 포인트 이력 조회 API

* **Endpoint**: `GET /points/{userId}/history`

```json
{
  "success": true,
  "message": "성공",
  "data": [
    {
      "pointHistoryId": 1,
      "amount": 1000,
      "type": "CHARGE",
      "createdDt": "2025-07-17T15:30:00",
      "balanceAfter": 9500
    }
  ],
  "status": 200
}
```

| 상태 코드 | 메시지                | 설명 |
| ----- | ------------------ | -- |
| 404   | 해당 사용자를 찾을 수 없습니다. | 없음 |

---

## 5. 상품 전체 조회 API

* **Endpoint**: `GET /products`

```json
{
  "success": true,
  "message": "성공",
  "data": [
    { "productId": 1, "name": "상품1", "price": 10000, "stock": 50 }
  ],
  "status": 200
}
```

| 상태 코드 | 메시지      | 설명       |
| ----- | -------- | -------- |
| 500   | 서버 오류 발생 | 내부 서버 오류 |

---

## 6. 상품 상세 조회 API

* **Endpoint**: `GET /products/{productId}`

```json
{
  "success": true,
  "message": "성공",
  "data": {
    "productId": 1,
    "name": "상품1",
    "price": 10000,
    "stock": 50
  },
  "status": 200
}
```

| 상태 코드 | 메시지               | 설명 |
| ----- | ----------------- | -- |
| 404   | 해당 상품을 찾을 수 없습니다. | 없음 |

---

## 7. 인기 상품 조회 API

* **Endpoint**: `GET /products/popular?days=3&limit=5`

```json
{
  "success": true,
  "message": "성공",
  "data": [
    { "productId": 1, "name": "상품1", "totalSold": 120 }
  ],
  "status": 200
}
```

| 상태 코드 | 메시지 | 설명                |
| ----- | --- | ----------------- |
| 200   | 성공  | 인기 상품 없으면 빈 배열 반환 |

---

## 8. 쿠폰 발급 API

* **Endpoint**: `POST /coupons/{userId}`

```json
// Request
{ "couponPolicyId": 1 }

// Success
{
  "success": true,
  "message": "쿠폰 발급 완료",
  "data": {
    "couponId": 5,
    "userId": 1,
    "couponPolicyId": 1,
    "name": "10% 할인 쿠폰",
    "discountRate": 10,
    "issuedAt": "2025-07-17T16:34:00",
    "expiredAt": "2025-07-24T23:59:59",
    "isUsed": false
  },
  "status": 200
}
```

| 상태 코드 | 메시지               | 설명           |
| ----- | ----------------- | ------------ |
| 400   | 이미 소진되었습니다.       | 수량 초과        |
| 400   | 쿠폰 정책을 찾을 수 없습니다. | 존재하지 않음      |
| 404   | 사용자를 찾을 수 없습니다.   | 없음           |
| 409   | 중복 발급 불가합니다.      | 동일 쿠폰 재발급 시도 |

---

## 9. 쿠폰 사용 가능 여부 API

* **Endpoint**: `GET /coupons/{couponId}/availability?userId={userId}`

```json
{
  "success": true,
  "message": "성공",
  "data": {
    "available": true,
    "reason": null,
    "coupon": {
      "couponId": 5,
      "couponPolicyId": 1,
      "name": "할인쿠폰",
      "discountRate": 10,
      "issuedDt": "2025-07-17T12:00:00",
      "expiredDt": "2025-07-31T23:59:59",
      "usedDt": null,
      "isUsed": false
    }
  },
  "status": 200
}
```

| 상태 코드 | 메시지               | 설명               |
| ----- | ----------------- | ---------------- |
| 400   | 쿠폰을 사용할 수 없습니다.   | 만료, 사용됨, 소유 아님 등 |
| 404   | 해당 쿠폰을 찾을 수 없습니다. | 없음               |

---

## 10. 보유 쿠폰 목록 조회 API

* **Endpoint**: `GET /coupons/{userId}`

```json
{
  "success": true,
  "message": "성공",
  "data": [
    {
      "couponId": 5,
      "couponPolicyId": 1,
      "name": "할인쿠폰",
      "discountRate": 10,
      "issuedDt": "2025-07-17T12:00:00",
      "expiredDt": "2025-07-31T23:59:59",
      "usedDt": null,
      "isUsed": false
    }
  ],
  "status": 200
}
```

| 상태 코드 | 메시지                | 설명 |
| ----- | ------------------ | -- |
| 404   | 해당 사용자를 찾을 수 없습니다. | 없음 |

---

## 11. 주문 요청 API

* **Endpoint**: `POST /orders`

```json
// Request
{
  "userId": 1,
  "items": [
    { "productId": 1, "itemCnt": 2 }
  ],
  "couponId": 5
}

// Success
{
  "success": true,
  "message": "주문 완료",
  "data": {
    "orderId": 100,
    "status": "COMPLETE",
    "totalAmount": 18000
  },
  "status": 200
}
```

| 상태 코드 | 메시지            | 설명            |
| ----- | -------------- | ------------- |
| 400   | 상품 재고가 부족합니다.  | 재고 부족         |
| 400   | 포인트가 부족합니다.    | 사용자 포인트 부족    |
| 400   | 쿠폰이 유효하지 않습니다. | 만료/사용됨        |
| 404   | 사용자 또는 상품 없음   | 존재하지 않는 ID 포함 |

---

## 12. 주문 내역 조회 API

* **Endpoint**: `GET /orders/{userId}`

```json
{
  "success": true,
  "message": "성공",
  "data": [
    {
      "orderId": 100,
      "orderedDt": "2025-07-17T16:00:00",
      "totalPrice": 18000,
      "status": "COMPLETE"
    }
  ],
  "status": 200
}
```

| 상태 코드 | 메시지 | 설명             |
| ----- | --- | -------------- |
| 200   | 성공  | 주문 없으면 빈 배열 반환 |

---

## 13. 주문 상세 조회 API

* **Endpoint**: `GET /orders/{orderId}`

```json
{
  "success": true,
  "message": "성공",
  "data": {
    "orderId": 100,
    "orderedDt": "2025-07-17T16:00:00",
    "status": "COMPLETE",
    "totalPrice": 18000,
    "couponId": 5,
    "items": [
      { "productId": 1, "itemCnt": 2, "unitPrice": 9000, "totalPrice": 18000 }
    ]
  },
  "status": 200
}
```

| 상태 코드 | 메시지               | 설명 |
| ----- | ----------------- | -- |
| 404   | 해당 주문을 찾을 수 없습니다. | 없음 |

---

## 14. 결제 내역 조회 API

* **Endpoint**: `GET /orders/{orderId}/payment`

```json
{
  "success": true,
  "message": "성공",
  "data": {
    "orderPaymentId": 20,
    "couponId": 5,
    "originalPrice": 20000,
    "discountAmount": 2000,
    "finalPrice": 18000,
    "paidDt": "2025-07-17T16:02:00"
  },
  "status": 200
}
```

| 상태 코드 | 메시지               | 설명          |
| ----- | ----------------- | ----------- |
| 404   | 해당 주문을 찾을 수 없습니다. | 결제 없는 경우 포함 |

---

## 15. 외부 시스템 주문 전달 API

* **Endpoint**: `POST /external/{orderId}`

```json
// Request
{
  "orderId": 100,
  "userId": 1,
  "totalAmount": 18000,
  "status": "SUCCESS",
  "reason": null,
  "items": [
    { "productId": 1, "item_cnt": 2 }
  ]
}

// Success
{
  "success": true,
  "message": "외부 시스템 처리 완료",
  "data": null,
  "status": 200
}
```

| 상태 코드 | 메시지       | 설명      |
| ----- | --------- | ------- |
| 500   | 외부 시스템 오류 | 처리 실패 시 |

---
